2025-09-30 19:55:00,669 [ERROR] poller: Single poll failed
Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_once.py", line 13, in handle
    poller.poll_all_devices()
    ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Command' object has no attribute 'poll_all_devices'
2025-09-30 19:57:19,541 [ERROR] poller: Single poll failed
Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_once.py", line 13, in handle
    poller.poll_all_devices()
    ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Command' object has no attribute 'poll_all_devices'
2025-09-30 20:05:15,817 [ERROR] poller: Single poll failed
Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_once.py", line 16, in handle
    poller.poll_all_devices()
    ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Command' object has no attribute 'poll_all_devices'
2025-10-08 19:19:53,062 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:19:55,262 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': True, 'last_seen': '2025-10-08T13:49:50.926851+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:19:57,352 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:19:59,400 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': False, 'last_seen': '2025-10-02T07:28:31.152534+00:00'}, 'alert': {'id': 48, 'title': 'Device Firewall Primary is down', 'severity': 'critical', 'created_at': '2025-10-08T13:49:55.322956+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:20:01,523 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:20:03,585 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 6, 'name': 'Switch T1', 'ip': '192.0.2.10', 'is_online': True, 'last_seen': '2025-10-08T13:49:59.480449+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:20:05,671 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:20:07,721 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 7, 'name': 'Router-Gate-B', 'ip': '192.168.1.8', 'is_online': True, 'last_seen': '2025-10-08T13:50:03.618627+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:20:09,871 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:20:11,919 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': True, 'last_seen': '2025-10-08T13:50:07.810113+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:20:14,036 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:20:16,094 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': False, 'last_seen': '2025-10-02T07:28:31.318048+00:00'}, 'alert': {'id': 52, 'title': 'Device Laptop-10-233-17-100 is down', 'severity': 'critical', 'created_at': '2025-10-08T13:50:12.004922+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:20:38,217 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:20:40,307 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 53, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-08T13:50:36.171552+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:21:18,346 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:21:20,409 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 54, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-08T13:51:16.324063+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:22:38,253 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:22:40,314 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 55, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-08T13:52:36.200627+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:23:58,473 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:24:00,512 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 56, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-08T13:53:56.434470+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:24:08,283 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:24:10,345 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 57, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-08T13:54:06.244615+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:31:27,418 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:31:29,477 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': False, 'last_seen': '2025-10-08T13:54:36.261531+00:00'}, 'alert': {'id': 58, 'title': 'Device Switch Terminal 1 is down', 'severity': 'critical', 'created_at': '2025-10-08T14:01:25.309240+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:31:31,557 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:31:33,610 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': True, 'last_seen': '2025-10-08T14:01:29.511275+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:31:35,678 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:31:37,737 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': False, 'last_seen': '2025-10-08T13:54:36.297891+00:00'}, 'alert': {'id': 60, 'title': 'Device Access Point Check-in is down', 'severity': 'critical', 'created_at': '2025-10-08T14:01:33.639805+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:31:39,875 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:31:41,911 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 6, 'name': 'Switch T1', 'ip': '192.0.2.10', 'is_online': False, 'last_seen': '2025-10-08T13:54:36.331686+00:00'}, 'alert': {'id': 61, 'title': 'Device Switch T1 is down', 'severity': 'critical', 'created_at': '2025-10-08T14:01:37.827737+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:31:44,061 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:31:46,130 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 10, 'name': 'DR-Sensor-01', 'ip': '10.0.3.10', 'is_online': False, 'last_seen': '2025-10-08T13:54:36.412149+00:00'}, 'alert': {'id': 62, 'title': 'Device DR-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-08T14:01:42.024203+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:32:58,410 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:33:00,477 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 63, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-08T14:02:56.351077+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:33:59,119 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:34:01,151 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 64, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-08T14:03:57.073399+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:34:09,218 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:34:11,242 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 65, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-08T14:04:07.176630+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:34:29,082 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:34:31,119 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 66, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-08T14:04:27.027930+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:34:39,187 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:34:41,236 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 67, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-08T14:04:37.126514+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:34:59,154 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:35:01,190 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 68, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-08T14:04:57.109830+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:35:49,110 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:35:51,141 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 69, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-08T14:05:47.073427+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:36:09,131 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:36:11,168 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 70, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-08T14:06:07.084807+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:36:59,139 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:37:01,161 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 7, 'name': 'Router-Gate-B', 'ip': '192.168.1.8', 'is_online': False, 'last_seen': '2025-10-08T14:06:47.091897+00:00'}, 'alert': {'id': 71, 'title': 'Device Router-Gate-B is down', 'severity': 'critical', 'created_at': '2025-10-08T14:06:57.095129+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:37:09,104 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:37:11,135 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 72, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-08T14:07:07.059810+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:37:13,244 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:37:15,276 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': False, 'last_seen': '2025-10-08T14:07:01.194845+00:00'}, 'alert': {'id': 73, 'title': 'Device DC2-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-08T14:07:11.216108+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:37:49,124 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:37:51,243 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': True, 'last_seen': '2025-10-08T14:07:47.077812+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:38:19,113 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:38:21,149 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 75, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-08T14:08:17.076150+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:39:09,167 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:39:11,219 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 76, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-08T14:09:07.147095+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:39:39,278 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:39:41,309 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': True, 'last_seen': '2025-10-08T14:09:37.227827+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:40:09,183 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:40:11,222 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': False, 'last_seen': '2025-10-08T14:09:57.124312+00:00'}, 'alert': {'id': 78, 'title': 'Device Switch Baggage Claim is down', 'severity': 'critical', 'created_at': '2025-10-08T14:10:07.135716+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:41:19,157 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:41:21,236 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': True, 'last_seen': '2025-10-08T14:11:17.108198+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:41:39,184 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:41:41,219 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 80, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-08T14:11:37.143239+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:41:59,192 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:42:01,246 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': False, 'last_seen': '2025-10-08T14:11:47.135858+00:00'}, 'alert': {'id': 81, 'title': 'Device Firewall Primary is down', 'severity': 'critical', 'created_at': '2025-10-08T14:11:57.146574+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:42:29,225 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:42:31,252 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': False, 'last_seen': '2025-10-08T14:12:17.199484+00:00'}, 'alert': {'id': 82, 'title': 'Device DC1-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-08T14:12:27.187358+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:42:49,176 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:42:51,210 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': False, 'last_seen': '2025-10-08T14:12:37.136823+00:00'}, 'alert': {'id': 83, 'title': 'Device Core Router Main is down', 'severity': 'critical', 'created_at': '2025-10-08T14:12:47.119503+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:43:29,695 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:43:31,728 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 10, 'name': 'DR-Sensor-01', 'ip': '10.0.3.10', 'is_online': True, 'last_seen': '2025-10-08T14:13:27.497248+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:44:19,281 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:44:21,314 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 6, 'name': 'Switch T1', 'ip': '192.0.2.10', 'is_online': True, 'last_seen': '2025-10-08T14:14:17.235493+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:44:49,217 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:44:51,263 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 86, 'device_id': 2, 'device_name': 'Switch Terminal 1', 'title': 'High memory usage on Switch Terminal 1', 'severity': 'warning', 'created_at': '2025-10-08T14:14:47.183182+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:44:59,326 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:45:01,365 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': False, 'last_seen': '2025-10-08T14:14:51.373507+00:00'}, 'alert': {'id': 87, 'title': 'Device Laptop-10-233-17-100 is down', 'severity': 'critical', 'created_at': '2025-10-08T14:14:57.290188+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:45:09,298 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:45:11,327 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 7, 'name': 'Router-Gate-B', 'ip': '192.168.1.8', 'is_online': True, 'last_seen': '2025-10-08T14:15:07.243180+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:45:13,429 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:45:15,465 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': True, 'last_seen': '2025-10-08T14:15:11.379121+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:45:39,287 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-08 19:45:41,452 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': True, 'last_seen': '2025-10-08T14:15:37.246600+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:25,108 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:27,255 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': True, 'last_seen': '2025-10-09T09:40:22.895616+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:29,368 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:31,412 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': True, 'last_seen': '2025-10-09T09:40:27.313807+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:33,520 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:35,913 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': False, 'last_seen': '2025-10-08T14:16:17.262411+00:00'}, 'alert': {'id': 93, 'title': 'Device Switch Baggage Claim is down', 'severity': 'critical', 'created_at': '2025-10-09T09:40:31.486818+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:38,411 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:40,707 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': True, 'last_seen': '2025-10-09T09:40:36.165366+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:43,026 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:45,098 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': True, 'last_seen': '2025-10-09T09:40:40.836887+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:52,405 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:54,450 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 96, 'device_id': 7, 'device_name': 'Router-Gate-B', 'title': 'High memory usage on Router-Gate-B', 'severity': 'warning', 'created_at': '2025-10-09T09:40:50.367309+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:56,587 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:10:58,637 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 97, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T09:40:54.539111+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:11:21,930 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:11:24,326 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 98, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T09:41:19.661794+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:11:36,647 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:11:38,703 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 99, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T09:41:34.608125+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:08,248 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:10,309 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': False, 'last_seen': '2025-10-09T09:41:39.616468+00:00'}, 'alert': {'id': 100, 'title': 'Device Access Point Check-in is down', 'severity': 'critical', 'created_at': '2025-10-09T09:42:06.102258+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:12,472 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:14,522 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': True, 'last_seen': '2025-10-09T09:42:10.398698+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:16,677 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:18,724 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 102, 'device_id': 7, 'device_name': 'Router-Gate-B', 'title': 'High memory usage on Router-Gate-B', 'severity': 'warning', 'created_at': '2025-10-09T09:42:14.625827+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:26,214 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:28,287 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 103, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T09:42:24.172267+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:31,172 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:33,225 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 104, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-09T09:42:29.121415+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:56,252 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:12:58,294 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 105, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T09:42:54.211867+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:13:31,962 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:13:34,011 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 106, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T09:43:29.815356+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:13:51,553 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:13:53,606 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 107, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T09:43:49.499020+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:14:26,539 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:14:28,630 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 108, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T09:44:24.483095+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:14:36,327 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:14:38,374 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 109, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-09T09:44:34.284092+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:14:41,288 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:14:43,352 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 110, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-09T09:44:39.241243+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:14:56,435 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:14:58,486 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 111, 'device_id': 7, 'device_name': 'Router-Gate-B', 'title': 'High memory usage on Router-Gate-B', 'severity': 'warning', 'created_at': '2025-10-09T09:44:54.378654+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:15:00,590 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:15:02,640 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 112, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T09:44:58.534441+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:15:14,960 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:15:17,020 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 113, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-09T09:45:12.917758+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:15:19,327 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:15:21,378 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 114, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T09:45:17.273394+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:15:23,500 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:15:25,701 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 115, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High cpu usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-09T09:45:21.443140+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:15:43,860 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:15:45,907 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 116, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T09:45:41.796198+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:16:08,919 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:16:10,994 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 117, 'device_id': 10, 'device_name': 'DR-Sensor-01', 'title': 'High memory usage on DR-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T09:46:06.838095+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:16:13,943 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:16:15,988 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 118, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T09:46:11.894498+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 205, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:38:12,504 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:38:15,206 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': False, 'last_seen': '2025-10-09T09:46:11.497040+00:00'}, 'alert': {'id': 119, 'title': 'Device Core Router Main is down', 'severity': 'critical', 'created_at': '2025-10-09T10:08:10.263872+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:38:17,334 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:38:19,395 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': False, 'last_seen': '2025-10-09T09:46:11.568843+00:00'}, 'alert': {'id': 120, 'title': 'Device Firewall Primary is down', 'severity': 'critical', 'created_at': '2025-10-09T10:08:15.292388+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:38:21,525 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:38:23,560 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': True, 'last_seen': '2025-10-09T10:08:19.450450+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:38:26,265 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:38:28,315 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 122, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T10:08:24.203323+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:38:44,618 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:38:47,384 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 123, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:08:42.147394+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:39:09,819 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:39:11,896 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 124, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:09:07.759400+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:39:38,176 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:39:40,227 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 125, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-09T10:09:36.120670+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:39:58,532 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:40:00,586 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 126, 'device_id': 2, 'device_name': 'Switch Terminal 1', 'title': 'High memory usage on Switch Terminal 1', 'severity': 'warning', 'created_at': '2025-10-09T10:09:56.492257+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:40:19,071 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:40:21,108 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 127, 'device_id': 6, 'device_name': 'Switch T1', 'title': 'High memory usage on Switch T1', 'severity': 'warning', 'created_at': '2025-10-09T10:10:17.026459+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:11,568 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:13,633 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 128, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:11:09.519053+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:15,994 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:18,065 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 129, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:11:13.946025+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:20,442 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:22,479 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 130, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T10:11:18.381599+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:32,711 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:34,765 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 131, 'device_id': 7, 'device_name': 'Router-Gate-B', 'title': 'High memory usage on Router-Gate-B', 'severity': 'warning', 'created_at': '2025-10-09T10:11:30.670086+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:41,150 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:43,203 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 132, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:11:39.106530+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:53,450 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:41:55,504 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 133, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-09T10:11:51.400973+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:13,908 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:15,967 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 134, 'device_id': 7, 'device_name': 'Router-Gate-B', 'title': 'High cpu usage on Router-Gate-B', 'severity': 'warning', 'created_at': '2025-10-09T10:12:11.861710+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:18,115 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:20,164 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 135, 'device_id': 10, 'device_name': 'DR-Sensor-01', 'title': 'High memory usage on DR-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:12:16.066668+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:22,260 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:24,312 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 136, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T10:12:20.217198+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:30,596 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:32,646 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 137, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:12:28.553725+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:34,998 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:37,039 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 138, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:12:32.950994+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:55,383 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:57,448 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 139, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:12:53.349670+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:42:59,526 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:01,574 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 140, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:12:57.483220+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:23,803 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:25,862 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': True, 'last_seen': '2025-10-09T10:13:21.726497+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:28,120 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:30,181 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': False, 'last_seen': '2025-10-09T10:13:17.910905+00:00'}, 'alert': {'id': 142, 'title': 'Device DC2-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:13:26.070054+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:32,372 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:34,446 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': False, 'last_seen': '2025-10-09T10:13:25.894973+00:00'}, 'alert': {'id': 143, 'title': 'Device Switch Terminal 1 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:13:30.316739+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:36,644 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:38,687 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': False, 'last_seen': '2025-10-09T10:13:26.036302+00:00'}, 'alert': {'id': 144, 'title': 'Device DC1-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:13:34.600361+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:48,862 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:50,908 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 145, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-09T10:13:46.805447+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:53,235 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:55,288 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 146, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-09T10:13:51.182742+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:57,399 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:43:59,446 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': True, 'last_seen': '2025-10-09T10:13:55.355381+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:01,655 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:03,697 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 148, 'device_id': 10, 'device_name': 'DR-Sensor-01', 'title': 'High memory usage on DR-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:13:59.626160+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:05,909 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:07,966 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': False, 'last_seen': '2025-10-09T10:13:59.478956+00:00'}, 'alert': {'id': 149, 'title': 'Device Access Point Check-in is down', 'severity': 'critical', 'created_at': '2025-10-09T10:14:03.847313+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:10,338 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:12,395 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 150, 'device_id': 6, 'device_name': 'Switch T1', 'title': 'High memory usage on Switch T1', 'severity': 'warning', 'created_at': '2025-10-09T10:14:08.284701+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:14,703 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:16,763 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 6, 'name': 'Switch T1', 'ip': '192.0.2.10', 'is_online': False, 'last_seen': '2025-10-09T10:14:08.269076+00:00'}, 'alert': {'id': 151, 'title': 'Device Switch T1 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:14:12.644631+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:27,170 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:29,219 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 152, 'device_id': 10, 'device_name': 'DR-Sensor-01', 'title': 'High memory usage on DR-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:14:25.131469+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:55,453 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:44:57,516 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': False, 'last_seen': '2025-10-09T10:14:49.418773+00:00'}, 'alert': {'id': 153, 'title': 'Device Switch Baggage Claim is down', 'severity': 'critical', 'created_at': '2025-10-09T10:14:53.387956+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:45:03,836 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:45:05,881 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 7, 'name': 'Router-Gate-B', 'ip': '192.168.1.8', 'is_online': False, 'last_seen': '2025-10-09T10:14:57.792523+00:00'}, 'alert': {'id': 154, 'title': 'Device Router-Gate-B is down', 'severity': 'critical', 'created_at': '2025-10-09T10:15:01.780513+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:45:08,001 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:45:10,064 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 10, 'name': 'DR-Sensor-01', 'ip': '10.0.3.10', 'is_online': False, 'last_seen': '2025-10-09T10:14:57.839631+00:00'}, 'alert': {'id': 155, 'title': 'Device DR-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:15:05.945138+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:45:20,363 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:45:22,403 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 156, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T10:15:18.304169+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:45:28,531 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:45:30,582 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 157, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-09T10:15:26.482117+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:47:37,021 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:47:39,091 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 158, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-09T10:17:34.975925+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:47:45,560 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:47:47,619 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': False, 'last_seen': '2025-10-09T10:17:39.453909+00:00'}, 'alert': {'id': 159, 'title': 'Device Laptop-10-233-17-100 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:17:43.497206+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:47:57,799 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:47:59,841 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 160, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-09T10:17:55.759297+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:48:26,119 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:48:28,165 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 161, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-09T10:18:24.081654+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:48:38,434 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:48:40,491 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': True, 'last_seen': '2025-10-09T10:18:36.370700+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:48:54,773 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:48:56,832 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': False, 'last_seen': '2025-10-09T10:18:48.687256+00:00'}, 'alert': {'id': 163, 'title': 'Device Core Router Main is down', 'severity': 'critical', 'created_at': '2025-10-09T10:18:52.688984+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:49:27,197 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:49:29,265 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 164, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-09T10:19:25.155154+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:49:39,555 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:49:41,596 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': True, 'last_seen': '2025-10-09T10:19:37.495766+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:49:47,839 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:49:49,901 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': False, 'last_seen': '2025-10-09T10:19:41.804713+00:00'}, 'alert': {'id': 166, 'title': 'Device Firewall Primary is down', 'severity': 'critical', 'created_at': '2025-10-09T10:19:45.790499+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:00,236 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:02,285 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 167, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-09T10:19:58.190194+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:04,430 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:06,488 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': True, 'last_seen': '2025-10-09T10:20:02.383714+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:20,764 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:22,820 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': True, 'last_seen': '2025-10-09T10:20:18.677851+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:33,208 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:35,273 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': True, 'last_seen': '2025-10-09T10:20:31.130357+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:41,516 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:43,579 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 7, 'name': 'Router-Gate-B', 'ip': '192.168.1.8', 'is_online': True, 'last_seen': '2025-10-09T10:20:39.467323+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:49,834 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:51,894 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 172, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-09T10:20:47.797036+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:50:58,276 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:51:00,315 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 173, 'device_id': 7, 'device_name': 'Router-Gate-B', 'title': 'High memory usage on Router-Gate-B', 'severity': 'warning', 'created_at': '2025-10-09T10:20:56.208619+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:51:02,545 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:51:04,599 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 174, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-09T10:21:00.509766+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:51:19,060 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:51:21,121 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 10, 'name': 'DR-Sensor-01', 'ip': '10.0.3.10', 'is_online': True, 'last_seen': '2025-10-09T10:21:17.000196+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:52:15,476 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:52:17,519 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 6, 'name': 'Switch T1', 'ip': '192.0.2.10', 'is_online': True, 'last_seen': '2025-10-09T10:22:13.422957+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:53:15,999 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:53:18,023 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 177, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:23:13.970422+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:53:24,349 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:53:26,389 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 178, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:23:22.304071+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:53:36,747 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:53:38,786 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 179, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:23:34.693732+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:53:44,930 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:53:46,994 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': False, 'last_seen': '2025-10-09T10:23:38.883399+00:00'}, 'alert': {'id': 180, 'title': 'Device Switch Terminal 1 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:23:42.875181+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:54:13,357 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:54:15,400 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': True, 'last_seen': '2025-10-09T10:24:11.300417+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:54:17,866 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:54:19,917 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 182, 'device_id': 7, 'device_name': 'Router-Gate-B', 'title': 'High cpu usage on Router-Gate-B', 'severity': 'warning', 'created_at': '2025-10-09T10:24:15.809568+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:54:26,256 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:54:28,312 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 183, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:24:24.217385+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:54:54,602 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:54:56,658 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': False, 'last_seen': '2025-10-09T10:24:48.566408+00:00'}, 'alert': {'id': 184, 'title': 'Device Access Point Check-in is down', 'severity': 'critical', 'created_at': '2025-10-09T10:24:52.547328+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:55:07,046 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:55:09,092 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 185, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-09T10:25:04.994444+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:55:11,423 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:55:13,509 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 186, 'device_id': 6, 'device_name': 'Switch T1', 'title': 'High memory usage on Switch T1', 'severity': 'warning', 'created_at': '2025-10-09T10:25:09.383139+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:55:15,607 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:55:17,654 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': False, 'last_seen': '2025-10-09T10:25:09.178931+00:00'}, 'alert': {'id': 187, 'title': 'Device DC1-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:25:13.557477+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:04,002 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:06,056 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 7, 'name': 'Router-Gate-B', 'ip': '192.168.1.8', 'is_online': False, 'last_seen': '2025-10-09T10:25:57.959366+00:00'}, 'alert': {'id': 188, 'title': 'Device Router-Gate-B is down', 'severity': 'critical', 'created_at': '2025-10-09T10:26:01.950425+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:20,309 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:22,372 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': False, 'last_seen': '2025-10-09T10:26:14.252092+00:00'}, 'alert': {'id': 189, 'title': 'Device Switch Baggage Claim is down', 'severity': 'critical', 'created_at': '2025-10-09T10:26:18.260478+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:28,714 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:30,758 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': False, 'last_seen': '2025-10-09T10:26:22.679290+00:00'}, 'alert': {'id': 190, 'title': 'Device DC2-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:26:26.656808+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:32,903 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:34,954 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 191, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-09T10:26:30.841727+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:49,371 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:51,414 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 192, 'device_id': 10, 'device_name': 'DR-Sensor-01', 'title': 'High memory usage on DR-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:26:47.326598+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:53,525 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:56:55,575 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 193, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-09T10:26:51.493511+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:57:01,960 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:57:04,005 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 194, 'device_id': 6, 'device_name': 'Switch T1', 'title': 'High memory usage on Switch T1', 'severity': 'warning', 'created_at': '2025-10-09T10:26:59.917170+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:57:06,238 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:57:08,274 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': True, 'last_seen': '2025-10-09T10:27:04.172365+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:57:10,611 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:57:12,672 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 196, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-09T10:27:08.548603+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:57:15,138 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:57:17,191 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': True, 'last_seen': '2025-10-09T10:27:13.077896+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:57:23,365 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:57:25,420 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 6, 'name': 'Switch T1', 'ip': '192.0.2.10', 'is_online': False, 'last_seen': '2025-10-09T10:27:17.311146+00:00'}, 'alert': {'id': 198, 'title': 'Device Switch T1 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:27:21.313211+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:58:07,768 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:58:09,824 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 199, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-09T10:28:05.700076+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:59:12,169 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:59:14,211 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': True, 'last_seen': '2025-10-09T10:29:10.115876+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:59:16,662 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:59:18,713 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 201, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-09T10:29:14.616942+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:59:44,863 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:59:46,927 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 202, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-09T10:29:42.823781+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:59:49,208 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 15:59:51,251 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 203, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-09T10:29:47.162963+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:00:01,716 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:00:03,766 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 10, 'name': 'DR-Sensor-01', 'ip': '10.0.3.10', 'is_online': False, 'last_seen': '2025-10-09T10:29:55.640274+00:00'}, 'alert': {'id': 204, 'title': 'Device DR-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:29:59.693315+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:00:09,954 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:00:12,013 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 205, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-09T10:30:07.918292+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:00:30,243 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:00:32,310 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': False, 'last_seen': '2025-10-09T10:30:24.204299+00:00'}, 'alert': {'id': 206, 'title': 'Device Core Router Main is down', 'severity': 'critical', 'created_at': '2025-10-09T10:30:28.206481+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:01:26,825 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:01:28,880 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': True, 'last_seen': '2025-10-09T10:31:24.740254+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:01:51,205 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:01:53,249 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': True, 'last_seen': '2025-10-09T10:31:49.150919+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:11,493 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:13,537 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': True, 'last_seen': '2025-10-09T10:32:09.404748+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:15,850 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:17,922 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': True, 'last_seen': '2025-10-09T10:32:13.782798+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:32,311 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:34,357 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 6, 'name': 'Switch T1', 'ip': '192.0.2.10', 'is_online': True, 'last_seen': '2025-10-09T10:32:30.248725+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:36,574 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:38,627 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': False, 'last_seen': '2025-10-09T10:32:30.169836+00:00'}, 'alert': {'id': 212, 'title': 'Device Firewall Primary is down', 'severity': 'critical', 'created_at': '2025-10-09T10:32:34.530460+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:40,716 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:42,766 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 213, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-09T10:32:38.658751+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:45,020 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:47,061 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 214, 'device_id': 2, 'device_name': 'Switch Terminal 1', 'title': 'High memory usage on Switch Terminal 1', 'severity': 'warning', 'created_at': '2025-10-09T10:32:42.981104+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:57,441 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:02:59,494 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 215, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-09T10:32:55.375259+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:03:01,870 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:03:03,916 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 7, 'name': 'Router-Gate-B', 'ip': '192.168.1.8', 'is_online': True, 'last_seen': '2025-10-09T10:32:59.816832+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:03:46,209 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:03:48,263 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 217, 'device_id': 2, 'device_name': 'Switch Terminal 1', 'title': 'High memory usage on Switch Terminal 1', 'severity': 'warning', 'created_at': '2025-10-09T10:33:44.150899+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:03:58,812 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:04:00,850 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': False, 'last_seen': '2025-10-09T10:33:52.749155+00:00'}, 'alert': {'id': 218, 'title': 'Device Laptop-10-233-17-100 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:33:56.753657+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:04:03,012 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:04:05,065 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 219, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-09T10:34:00.958753+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:04:31,557 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:04:33,609 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 220, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:34:29.489510+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:04:43,926 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:04:45,966 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 221, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:34:41.879963+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:04:52,197 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:04:54,270 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 222, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-09T10:34:50.147252+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:04,638 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:06,682 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 223, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-09T10:35:02.546126+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:13,040 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:15,101 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 224, 'device_id': 6, 'device_name': 'Switch T1', 'title': 'High memory usage on Switch T1', 'severity': 'warning', 'created_at': '2025-10-09T10:35:10.992510+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:33,506 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:35,541 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 10, 'name': 'DR-Sensor-01', 'ip': '10.0.3.10', 'is_online': True, 'last_seen': '2025-10-09T10:35:31.458711+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:45,820 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:47,861 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 226, 'device_id': 7, 'device_name': 'Router-Gate-B', 'title': 'High memory usage on Router-Gate-B', 'severity': 'warning', 'created_at': '2025-10-09T10:35:43.770561+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:49,957 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:52,016 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 227, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-09T10:35:47.908435+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:05:58,190 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:06:00,232 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': True, 'last_seen': '2025-10-09T10:35:56.120917+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:06:30,701 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:06:32,749 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 229, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-09T10:36:28.646878+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:06:34,838 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:06:36,869 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 230, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-09T10:36:32.796941+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:06:39,132 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:06:41,168 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 231, 'device_id': 2, 'device_name': 'Switch Terminal 1', 'title': 'High memory usage on Switch Terminal 1', 'severity': 'warning', 'created_at': '2025-10-09T10:36:37.093598+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:07:03,510 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:07:05,548 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': False, 'last_seen': '2025-10-09T10:36:57.442864+00:00'}, 'alert': {'id': 232, 'title': 'Device Switch Terminal 1 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:37:01.459467+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:07:08,005 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:07:10,039 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': False, 'last_seen': '2025-10-09T10:37:05.685520+00:00'}, 'alert': {'id': 233, 'title': 'Device DC1-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:37:05.954102+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:07:24,427 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:07:26,465 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': False, 'last_seen': '2025-10-09T10:37:18.351543+00:00'}, 'alert': {'id': 234, 'title': 'Device DC2-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-09T10:37:22.367805+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:08:04,763 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:08:06,821 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 235, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-09T10:38:02.707878+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:08:09,075 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:08:11,139 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': True, 'last_seen': '2025-10-09T10:38:07.020060+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:08:21,467 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-09 16:08:23,497 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': False, 'last_seen': '2025-10-09T10:38:15.419861+00:00'}, 'alert': {'id': 237, 'title': 'Device Access Point Check-in is down', 'severity': 'critical', 'created_at': '2025-10-09T10:38:19.415880+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:40:11,334 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:40:13,393 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': True, 'last_seen': '2025-10-10T05:10:09.213498+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:40:15,532 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:40:17,575 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': True, 'last_seen': '2025-10-10T05:10:13.467671+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:40:19,690 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:40:21,725 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': True, 'last_seen': '2025-10-10T05:10:17.660032+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:40:23,839 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:40:25,875 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': True, 'last_seen': '2025-10-10T05:10:21.758471+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:40:27,962 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:40:29,992 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': True, 'last_seen': '2025-10-10T05:10:25.917711+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:41:16,163 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:41:18,206 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 243, 'device_id': 3, 'device_name': 'Firewall Primary', 'title': 'High memory usage on Firewall Primary', 'severity': 'warning', 'created_at': '2025-10-10T05:11:14.138640+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:41:20,541 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:41:22,585 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 244, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-10T05:11:18.510508+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:41:36,906 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:41:38,959 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 245, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-10T05:11:34.855144+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:42:53,300 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:42:55,336 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 246, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-10T05:12:51.246592+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:43:09,829 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:43:11,883 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 247, 'device_id': 10, 'device_name': 'DR-Sensor-01', 'title': 'High memory usage on DR-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-10T05:13:07.788153+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:43:38,305 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:43:40,329 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 248, 'device_id': 6, 'device_name': 'Switch T1', 'title': 'High memory usage on Switch T1', 'severity': 'warning', 'created_at': '2025-10-10T05:13:36.242525+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:43:50,705 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:43:52,754 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 249, 'device_id': 6, 'device_name': 'Switch T1', 'title': 'High memory usage on Switch T1', 'severity': 'warning', 'created_at': '2025-10-10T05:13:48.602782+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:44:58,983 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:01,014 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 250, 'device_id': 2, 'device_name': 'Switch Terminal 1', 'title': 'High memory usage on Switch Terminal 1', 'severity': 'warning', 'created_at': '2025-10-10T05:14:56.948459+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:11,280 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:13,316 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 251, 'device_id': 2, 'device_name': 'Switch Terminal 1', 'title': 'High memory usage on Switch Terminal 1', 'severity': 'warning', 'created_at': '2025-10-10T05:15:09.249607+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:19,732 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:21,751 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 252, 'device_id': 10, 'device_name': 'DR-Sensor-01', 'title': 'High memory usage on DR-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-10T05:15:17.703399+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:23,847 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:25,887 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': False, 'last_seen': '2025-10-10T05:15:17.505733+00:00'}, 'alert': {'id': 253, 'title': 'Device Core Router Main is down', 'severity': 'critical', 'created_at': '2025-10-10T05:15:21.804968+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:28,080 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:30,132 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': False, 'last_seen': '2025-10-10T05:15:17.674521+00:00'}, 'alert': {'id': 254, 'title': 'Device DC2-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:15:26.051563+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:32,197 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:34,230 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 10, 'name': 'DR-Sensor-01', 'ip': '10.0.3.10', 'is_online': False, 'last_seen': '2025-10-10T05:15:17.692857+00:00'}, 'alert': {'id': 255, 'title': 'Device DR-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:15:30.159556+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:36,414 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:38,446 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': False, 'last_seen': '2025-10-10T05:15:25.955874+00:00'}, 'alert': {'id': 256, 'title': 'Device Access Point Check-in is down', 'severity': 'critical', 'created_at': '2025-10-10T05:15:34.305505+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    alert = Alert.objects.create(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:44,631 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:45:46,664 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': False, 'last_seen': '2025-10-10T05:15:38.603714+00:00'}, 'alert': {'id': 257, 'title': 'Device Switch Terminal 1 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:15:42.603478+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    try:
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:08,913 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:10,929 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 258, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-10T05:16:06.889850+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:12,995 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:15,042 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 6, 'name': 'Switch T1', 'ip': '192.0.2.10', 'is_online': False, 'last_seen': '2025-10-10T05:16:02.934540+00:00'}, 'alert': {'id': 259, 'title': 'Device Switch T1 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:16:10.951883+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:17,195 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:19,242 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 260, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-10T05:16:15.150320+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:21,364 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:23,415 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': False, 'last_seen': '2025-10-10T05:16:06.879257+00:00'}, 'alert': {'id': 261, 'title': 'Device Switch Baggage Claim is down', 'severity': 'critical', 'created_at': '2025-10-10T05:16:19.319957+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:33,713 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:35,773 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': False, 'last_seen': '2025-10-10T05:16:27.680711+00:00'}, 'alert': {'id': 262, 'title': 'Device Laptop-10-233-17-100 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:16:31.659077+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:37,892 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:39,913 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 7, 'name': 'Router-Gate-B', 'ip': '192.168.1.8', 'is_online': False, 'last_seen': '2025-10-10T05:16:31.600507+00:00'}, 'alert': {'id': 263, 'title': 'Device Router-Gate-B is down', 'severity': 'critical', 'created_at': '2025-10-10T05:16:35.866837+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:42,092 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:46:44,129 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': False, 'last_seen': '2025-10-10T05:16:39.941136+00:00'}, 'alert': {'id': 264, 'title': 'Device DC1-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:16:40.067319+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:47:22,275 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:47:24,317 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': False, 'last_seen': '2025-10-10T05:17:16.223701+00:00'}, 'alert': {'id': 265, 'title': 'Device Firewall Primary is down', 'severity': 'critical', 'created_at': '2025-10-10T05:17:20.242534+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:50:26,533 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:50:28,590 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': True, 'last_seen': '2025-10-10T05:20:24.480721+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:50:54,824 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:50:56,870 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': True, 'last_seen': '2025-10-10T05:20:52.758037+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:51:27,156 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:51:29,194 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': True, 'last_seen': '2025-10-10T05:21:25.085970+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:51:47,370 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:51:49,417 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': True, 'last_seen': '2025-10-10T05:21:45.301817+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:51:51,557 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:51:53,612 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': True, 'last_seen': '2025-10-10T05:21:49.520892+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:51:55,759 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:51:57,806 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': True, 'last_seen': '2025-10-10T05:21:53.702704+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:52:11,992 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:52:14,017 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 272, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-10T05:22:09.953826+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:52:28,262 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:52:30,288 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 273, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-10T05:22:26.219987+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:52:56,610 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:52:58,629 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 274, 'device_id': 9, 'device_name': 'DC2-Sensor-01', 'title': 'High memory usage on DC2-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-10T05:22:54.572302+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:00,779 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:02,800 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 275, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-10T05:22:58.744094+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:04,920 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:06,933 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 10, 'name': 'DR-Sensor-01', 'ip': '10.0.3.10', 'is_online': True, 'last_seen': '2025-10-10T05:23:02.871306+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:13,046 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:15,079 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': True, 'last_seen': '2025-10-10T05:23:11.003073+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:17,282 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:19,304 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': True, 'last_seen': '2025-10-10T05:23:15.241200+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:37,549 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:39,571 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 279, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-10T05:23:35.504131+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:49,750 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:51,781 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 280, 'device_id': 8, 'device_name': 'DC1-Sensor-01', 'title': 'High memory usage on DC1-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-10T05:23:47.717579+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:54,042 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:53:56,060 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 281, 'device_id': 10, 'device_name': 'DR-Sensor-01', 'title': 'High memory usage on DR-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-10T05:23:52.009519+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:54:30,296 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:54:32,321 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 282, 'device_id': 10, 'device_name': 'DR-Sensor-01', 'title': 'High memory usage on DR-Sensor-01', 'severity': 'warning', 'created_at': '2025-10-10T05:24:28.257234+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:54:34,457 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:54:36,487 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 283, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-10T05:24:32.441372+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:55:46,766 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:55:48,812 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 284, 'device_id': 4, 'device_name': 'Access Point Check-in', 'title': 'High memory usage on Access Point Check-in', 'severity': 'warning', 'created_at': '2025-10-10T05:25:44.712487+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:56:07,161 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:56:09,186 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 285, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-10T05:26:05.117638+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:56:19,425 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:56:21,451 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 286, 'device_id': 1, 'device_name': 'Core Router Main', 'title': 'High memory usage on Core Router Main', 'severity': 'warning', 'created_at': '2025-10-10T05:26:17.336504+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:56:39,820 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:56:41,887 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 287, 'device_id': 5, 'device_name': 'Switch Baggage Claim', 'title': 'High memory usage on Switch Baggage Claim', 'severity': 'warning', 'created_at': '2025-10-10T05:26:37.781089+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:56:44,136 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:56:46,183 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 6, 'name': 'Switch T1', 'ip': '192.0.2.10', 'is_online': True, 'last_seen': '2025-10-10T05:26:42.081939+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:57:08,535 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:57:10,581 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 7, 'name': 'Router-Gate-B', 'ip': '192.168.1.8', 'is_online': True, 'last_seen': '2025-10-10T05:27:06.464067+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:57:28,917 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:57:30,953 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 9, 'name': 'DC2-Sensor-01', 'ip': '10.0.2.10', 'is_online': False, 'last_seen': '2025-10-10T05:27:22.878302+00:00'}, 'alert': {'id': 290, 'title': 'Device DC2-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:27:26.868686+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:57:53,162 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:57:55,227 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': False, 'last_seen': '2025-10-10T05:27:47.118847+00:00'}, 'alert': {'id': 291, 'title': 'Device Switch Baggage Claim is down', 'severity': 'critical', 'created_at': '2025-10-10T05:27:51.130750+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:58:01,433 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:58:03,492 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 1, 'name': 'Core Router Main', 'ip': '192.168.1.1', 'is_online': False, 'last_seen': '2025-10-10T05:27:55.357352+00:00'}, 'alert': {'id': 292, 'title': 'Device Core Router Main is down', 'severity': 'critical', 'created_at': '2025-10-10T05:27:59.372188+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:58:21,849 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:58:23,896 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 293, 'device_id': 6, 'device_name': 'Switch T1', 'title': 'High memory usage on Switch T1', 'severity': 'warning', 'created_at': '2025-10-10T05:28:19.800911+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:58:54,086 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:58:56,136 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': False, 'last_seen': '2025-10-10T05:28:48.019503+00:00'}, 'alert': {'id': 294, 'title': 'Device Switch Terminal 1 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:28:52.022905+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:06,525 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:08,551 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 10, 'name': 'DR-Sensor-01', 'ip': '10.0.3.10', 'is_online': False, 'last_seen': '2025-10-10T05:29:00.467343+00:00'}, 'alert': {'id': 295, 'title': 'Device DR-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:29:04.460706+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:38,833 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:40,881 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 8, 'name': 'DC1-Sensor-01', 'ip': '10.0.1.10', 'is_online': False, 'last_seen': '2025-10-10T05:29:32.767275+00:00'}, 'alert': {'id': 296, 'title': 'Device DC1-Sensor-01 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:29:36.787481+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:43,063 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:45,091 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 297, 'device_id': 6, 'device_name': 'Switch T1', 'title': 'High memory usage on Switch T1', 'severity': 'warning', 'created_at': '2025-10-10T05:29:41.023506+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:47,492 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:49,523 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 298, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-10T05:29:45.427874+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:55,656 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:57,690 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 3, 'name': 'Firewall Primary', 'ip': '192.168.1.254', 'is_online': False, 'last_seen': '2025-10-10T05:29:49.558485+00:00'}, 'alert': {'id': 299, 'title': 'Device Firewall Primary is down', 'severity': 'critical', 'created_at': '2025-10-10T05:29:53.583248+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 10:59:59,989 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:00:02,007 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 300, 'device_id': 6, 'device_name': 'Switch T1', 'title': 'High memory usage on Switch T1', 'severity': 'warning', 'created_at': '2025-10-10T05:29:57.951156+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:00:08,339 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:00:10,389 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 301, 'device_id': 11, 'device_name': 'Laptop-10-233-17-100', 'title': 'High memory usage on Laptop-10-233-17-100', 'severity': 'warning', 'created_at': '2025-10-10T05:30:06.311333+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:00:52,591 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:00:54,635 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 11, 'name': 'Laptop-10-233-17-100', 'ip': '10.233.17.100', 'is_online': False, 'last_seen': '2025-10-10T05:30:46.547268+00:00'}, 'alert': {'id': 302, 'title': 'Device Laptop-10-233-17-100 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:30:50.552297+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:01:00,717 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:01:02,752 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 4, 'name': 'Access Point Check-in', 'ip': '192.168.1.50', 'is_online': False, 'last_seen': '2025-10-10T05:30:54.683685+00:00'}, 'alert': {'id': 303, 'title': 'Device Access Point Check-in is down', 'severity': 'critical', 'created_at': '2025-10-10T05:30:58.689706+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:02:09,108 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:02:11,187 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 6, 'name': 'Switch T1', 'ip': '192.0.2.10', 'is_online': False, 'last_seen': '2025-10-10T05:32:02.952734+00:00'}, 'alert': {'id': 304, 'title': 'Device Switch T1 is down', 'severity': 'critical', 'created_at': '2025-10-10T05:32:07.062803+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:02:49,423 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:02:51,464 [ERROR] poller: Failed to send websocket update: {'type': 'alert_triggered', 'alert': {'id': 305, 'device_id': 7, 'device_name': 'Router-Gate-B', 'title': 'High memory usage on Router-Gate-B', 'severity': 'warning', 'created_at': '2025-10-10T05:32:47.394503+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:02:57,659 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:02:59,686 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'went_offline', 'device': {'id': 7, 'name': 'Router-Gate-B', 'ip': '192.168.1.8', 'is_online': False, 'last_seen': '2025-10-10T05:32:51.621865+00:00'}, 'alert': {'id': 306, 'title': 'Device Router-Gate-B is down', 'severity': 'critical', 'created_at': '2025-10-10T05:32:55.608963+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:03:01,848 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:03:03,896 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 5, 'name': 'Switch Baggage Claim', 'ip': '192.168.1.20', 'is_online': True, 'last_seen': '2025-10-10T05:32:59.802223+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:04:02,218 [ERROR] poller: Failed to broadcast alert via signal: Error 22 connecting to 127.0.0.1:6379. 22.
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\signals.py", line 34, in alert_post_save
    async_to_sync(channel_layer.group_send)(
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
2025-10-10 11:04:04,255 [ERROR] poller: Failed to send websocket update: {'type': 'device_update', 'change': 'back_online', 'device': {'id': 2, 'name': 'Switch Terminal 1', 'ip': '192.168.1.10', 'is_online': True, 'last_seen': '2025-10-10T05:34:00.151747+00:00'}}
Traceback (most recent call last):
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 243, in connect
    await self.retry.call_with_retry(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\retry.py", line 59, in call_with_retry
    return await do()
           ^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 650, in _connect
    reader, writer = await asyncio.open_connection(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1119, in create_connection
    raise exceptions[0]
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1101, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\base_events.py", line 1004, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\proactor_events.py", line 727, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 798, in _poll
    value = callback(transferred, key, ov)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\asyncio\windows_events.py", line 594, in finish_connect
    ov.getresult()
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\netpulse\backend\api\management\commands\poll_devices.py", line 212, in send_ws_update
    'type': 'alert_triggered',
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 262, in __call__
    return call_result.result()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\karth\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\netpulse\backend\venv\Lib\site-packages\asgiref\sync.py", line 302, in main_wrap
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\channels_redis\core.py", line 523, in group_send
    await connection.zremrangebyscore(
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\client.py", line 601, in execute_command
    conn = self.connection or await pool.get_connection(command_name, **options)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1040, in get_connection
    await self.ensure_connection(connection)
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 1062, in ensure_connection
    await connection.connect()
  File "D:\netpulse\backend\venv\Lib\site-packages\redis\asyncio\connection.py", line 251, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 22 connecting to 127.0.0.1:6379. 22.
